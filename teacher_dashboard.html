<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard | Teacher</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { min-height: 100vh; background: #0f172a; color: white; padding: 40px; }
        .display-container { max-width: 1000px; margin: auto; background: rgba(255,255,255,0.03); border-radius: 30px; border: 1px solid rgba(255,255,255,0.1); padding: 30px; }
        
        /* Class Info Bar */
        .class-bar { 
            background: rgba(127, 90, 240, 0.1); 
            padding: 15px 25px; 
            border-radius: 15px; 
            margin-bottom: 25px; 
            border: 1px dashed #7f5af0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 10px; }
        .card { padding: 30px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; text-decoration: none; color: white; text-align: center; transition: 0.3s; }
        .card:hover { transform: translateY(-10px); background: rgba(127, 90, 240, 0.1); border-color: #7f5af0; }
        
        .btn-logout { padding: 8px 20px; border-radius: 50px; background: #f472b6; color: white; text-decoration: none; font-size: 14px; font-weight: bold; }
        .btn-switch { padding: 8px 15px; border-radius: 8px; background: #7f5af0; color: white; text-decoration: none; font-size: 12px; font-weight: bold; }
        
        h3 { margin-bottom: 8px; }
        p { font-size: 14px; color: #94a3b8; }
    </style>
</head>
<body>
    <div class="display-container">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 30px;">
            <h2 style="color: #7f5af0;">Teacher Console</h2>
            <a href="index.html" class="btn-logout">Logout</a>
        </div>

        <div class="class-bar">
            <div>
                <span style="color: #94a3b8; font-size: 13px;">Currently Managing:</span>
                <h2 id="activeClassName" style="color: #fff;">Loading...</h2>
            </div>
            <a href="class_management.html" class="btn-switch">Change Class</a>
        </div>

        <div class="grid">
            <a href="add_student.html" class="card" style="border-color: #22c55e;">
                <h3>Add Student</h3>
                <p>Register new profiles</p>
            </a>
            
            <a href="manage_students.html" class="card" style="border-color: #fbbf24;">
                <h3>Manage Students</h3>
                <p>Edit or Delete Records</p>
            </a>

            <a href="take_attendance.html" class="card" style="border-color: #ec4899;">
                <h3>Mark Attendance</h3>
                <p>Daily class sheet</p>
            </a>

            <a href="edit_attendance.html" class="card" style="border-color: #ef4444;">
                <h3>Edit Attendance</h3>
                <p>Modify past records</p>
            </a>

            <a href="view_records.html" class="card" style="border-color: #3b82f6;">
                <h3>View Records</h3>
                <p>History & PDF Download</p>
            </a>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // Firebase Configuration (Same as your main project)
        const firebaseConfig = {
    apiKey: "AIzaSyAL_IfQW5X3IuHU7ClkBQhRjTWEceF5Aio",
    authDomain: "attendance-system-123.firebaseapp.com",
    projectId: "attendance-system-123",
    storageBucket: "attendance-system-123.firebasestorage.app",
    messagingSenderId: "592694519186",
    appId: "1:592694519186:web:e4cc56fc44afd137770d4b",
    measurementId: "G-TWE5VVT6ZQ"
  };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        window.onload = async function() {
            // Local check for quick ID retrieval
            const currentClassId = localStorage.getItem('current_class_id');
            
            if (!currentClassId) {
                alert("Please select a class first!");
                window.location.href = 'class_management.html';
                return;
            }

            try {
                // Fetch only the specific class info from Firebase for speed
                const classRef = ref(db, 'cui_classes/' + currentClassId);
                const snapshot = await get(classRef);

                if (snapshot.exists()) {
                    const classData = snapshot.val();
                    document.getElementById('activeClassName').innerText = classData.className;
                } else {
                    alert("Class not found in cloud database!");
                    window.location.href = 'class_management.html';
                }
            } catch (error) {
                console.error("Firebase Error:", error);
                document.getElementById('activeClassName').innerText = "Error Loading Data";
            }
        };
    </script>
</body>
</html>